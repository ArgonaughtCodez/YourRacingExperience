<% include ../partials/header %>
<div class="welcomeBanner">
    <h1 class="welcomeH1 text-center"> Showing <span><%= series[0].series_name %></span> Posts!</h1>
</div>
<div class="seasonButtonHolder text-center" style="display:flex; flex-wrap: wrap;">
  <% var i = seasons.length %>
   <a class="seasonButton" href='/series/<%= series[0].series_short %>'> All</a>
  <% while (i--){ %>
    <% if(seasons[i].season_year === season){ %>
          <a class="seasonButton activeSeason" href='/season/<%= series[0].series_short %>/<%= seasons[i].season_year  %>'><%= seasons[i].season_year %></a>
    
    <% } else { %>
    
        <a class="seasonButton" href='/season/<%= series[0].series_short %>/<%= seasons[i].season_year  %>'><%= seasons[i].season_year %></a>
    
    <% } %>
    

  
  
  
  <% } %>
 
</div>

<div class="seasonBanner text-center">
         
        <select class="seasonSelector form-control" onchange="window.location=this.value">
          
          
          <option style="font-size: 18px;" value='/season/<%= series[0].series_short %>/<%= season  %>' > All </option>
          <% var i = races.length %>
          <% while (i--){ %>
            <% if( races[i].year === season){ %>
            
                  <% if (race === races[i].race_name){ %>
                    <option style="font-size: 18px; background-color: white; color: #353b48;" value='/race/<%= series[0].series_short %>/<%= season  %>/<%= races[i].race_name %>' class='list-item' selected><%= races[i].race_name %></option>
                  <% } else { %>
                    <option style="font-size: 18px; background-color: white; color: #353b48;" value='/race/<%= series[0].series_short %>/<%= season  %>/<%= races[i].race_name %>' class='list-item'><%= races[i].race_name %></option>
                  <% } %>
            <% } %>
          <% } %>
          </select>
</div>

<% if(count <= perPage){ %>

  
  
<% } else { %>  
<div class="row text-center">
    <% if (pages && pages > 0) { %>
    <%= pages %>
    <%= count %>
    <%= perPage %>
    <%= pages %>
    <ul class="pagination text-center">
        <% if (current == 1) { %>
        <li class="disabled"><a>First</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>">First</a></li>
        <% } %>
 
        <% if (current == 1) { %>
        <li class="disabled"><a>«</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= Number(current) - 1 %>">«</a></li>
        <% } %>
 
        <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
        <% if (i !== 1) { %>
        <li class="pageNumberGrp disabled"><a>...</a></li>
        <% } %>
        <% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
        <% if (i == current) { %>
        <li class="active"><a><%= i %></a></li>
        <% } else { %>
        <li><a class="pageNumberGrp" href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= i %>"><%= i %></a></li>
        <% } %>
        <% if (i == Number(current) + 4 && i < pages) { %>
        <li class="pageNumberGrp disabled"><a>...</a></li>
        <% } %>
        <% } %>
 
        <% if (current == pages) { %>
        <li class="disabled"><a>»</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= Number(current) + 1 %>">»</a></li>
        <% } %>
 
        <% if (current == pages) { %>
        <li class="disabled"><a>Last</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= pages %>">Last</a></li>
        <% } %>
    </ul>
    <% } %>
</div>
<% } %>

<div class="row" style="display:flex; flex-wrap: wrap;">


<% for (var i = 0; i < posts.length; i++){ %>
            <a href="/post/<%= posts[i]._id %>" type="button" class="thumbnail postLinks"
                      style="background:url(<%= posts[i].resizedImage %>); 
                      background-repeat: no-repeat;
                      background-position: center;
                      background-size:cover;
                      border-radius: 0 !important;
                      outline: 0 !important;"
            ></a>
<% }%>

</div>
<% if(count <= perPage){ %>

  
  
<% } else { %>  
<div class="row text-center">
    <% if (pages && pages > 0) { %>
    <%= pages %>
    <%= count %>
    <%= perPage %>
    <%= pages %>
    <ul class="pagination text-center">
        <% if (current == 1) { %>
        <li class="disabled"><a>First</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>">First</a></li>
        <% } %>
 
        <% if (current == 1) { %>
        <li class="disabled"><a>«</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= Number(current) - 1 %>">«</a></li>
        <% } %>
 
        <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
        <% if (i !== 1) { %>
        <li class="pageNumberGrp disabled"><a>...</a></li>
        <% } %>
        <% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
        <% if (i == current) { %>
        <li class="active"><a><%= i %></a></li>
        <% } else { %>
        <li><a class="pageNumberGrp" href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= i %>"><%= i %></a></li>
        <% } %>
        <% if (i == Number(current) + 4 && i < pages) { %>
        <li class="pageNumberGrp disabled"><a>...</a></li>
        <% } %>
        <% } %>
 
        <% if (current == pages) { %>
        <li class="disabled"><a>»</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= Number(current) + 1 %>">»</a></li>
        <% } %>
 
        <% if (current == pages) { %>
        <li class="disabled"><a>Last</a></li>
        <% } else { %>
        <li><a href="/race/<%= series[0].series_short %>/<%= season  %>/<%= race %>?page=<%= pages %>">Last</a></li>
        <% } %>
    </ul>
    <% } %>
</div>
<% } %>
</div>

<script>
$(document).ready(function () {
  $('select').each(function () {
    var select = $(this);
    var selectedValue = select.find('option[selected]').val();

    if (selectedValue) {
      select.val(selectedValue);
    } else {
      select.prop('selectedIndex', 0);
    }
  });
});
</script>
</body>
</html>